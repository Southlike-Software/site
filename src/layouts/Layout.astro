---
import PostHog from "../components/analytics/posthog.astro";
import Navbar from "../components/layout/Navbar.astro";
import Footer from "../components/layout/Footer.astro";
import MobileCTA from "../components/layout/MobileCTA.astro";
import "../styles/global.css";

interface Props {
  title?: string;
  description?: string;
  noindex?: boolean;
  image?: string;
  schema?: Record<string, any>;
}

const {
  title = "Southlike Software — IA e Automação para Empresas",
  description = "Automação inteligente com IA para acelerar o crescimento do seu negócio. Consultoria, implementação e suporte estratégico.",
  noindex = false,
  image = "/southlike-logo.png",
  schema,
} = Astro.props;

const siteOrigin = Astro.site ? Astro.site.toString() : "https://southlikesoftware.com";
const canonicalUrl = new URL(Astro.url.pathname, siteOrigin).toString();
const ogImageUrl = new URL(image, siteOrigin).toString();
const robotsContent = noindex ? "noindex, nofollow" : "index, follow";
---

<!doctype html>
<html lang="pt-BR" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/svg+xml" href="/southlike-logo.png" />
    <link rel="icon" href="/southlike-logo.png" type="image/png" sizes="32x32" />
    <link rel="apple-touch-icon" href="/southlike-logo.png" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    <meta name="description" content={description} />
    <meta name="theme-color" content="#0a0a0b" />
    <meta name="robots" content={robotsContent} />
    <link rel="canonical" href={canonicalUrl} />

    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="Southlike Software" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:image" content={ogImageUrl} />
    <meta property="og:image:alt" content={`Imagem de ${title}`} />
    <meta property="og:locale" content="pt_BR" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImageUrl} />
    <meta name="twitter:image:alt" content={`Imagem de ${title}`} />

    <link rel="alternate" href={canonicalUrl} hreflang="pt-BR" />
    <link rel="alternate" href={canonicalUrl} hreflang="x-default" />

    <script type="application/ld+json" set:html={JSON.stringify({
      '@context': 'https://schema.org',
      '@type': 'Organization',
      name: 'Southlike Software',
      url: siteOrigin,
      logo: ogImageUrl,
      sameAs: []
    })} />

    {schema && (
      <script type="application/ld+json" set:html={JSON.stringify(schema)} />
    )}

    <PostHog />
    <link rel="sitemap" href="/sitemap-index.xml" />
  </head>
  <body class="min-h-screen bg-surface-950 font-sans text-neutral-100 antialiased selection:bg-brand-500/20">
    <div class="flex min-h-screen flex-col">
      <Navbar />
      <a
        href="#conteudo"
        class="sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 focus:z-[100] focus:rounded focus:bg-surface-800 focus:px-3 focus:py-2"
      >Pular para o conteúdo</a>
      <main id="conteudo" class="flex-1 pt-16">
        <slot />
      </main>
      <Footer />
      <MobileCTA />
    </div>
  </body>
</html>
